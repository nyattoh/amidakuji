# リアルタイム あみだくじ

複数のユーザーで同時に操作できるリアルタイムあみだくじアプリケーションです。
状態が永続化されるため、異なる環境からアクセスしても同じ状態を維持できます。

## 機能

- リアルタイムな線の描画
- 複数ユーザー間での状態同期
- 結果のアニメーション表示
- 状態の永続化（自動保存）
- 自動再接続機能
- 接続状態の視覚的フィードバック
- エラー時の自動リカバリー

## 技術スタック

- Node.js
- Express
- Socket.IO
- HTML5 Canvas
- ファイルベースの状態管理

## セットアップ

1. 依存関係のインストール:
```bash
npm install
```

2. アプリケーションの起動:
```bash
npm start
```

## 使用方法

1. ブラウザで `http://localhost:3000` にアクセス
2. 縦線の間をクリックして横線を引く
3. 「結了」ボタンを押して結果を表示
4. スタートポイントをクリックしてアニメーションを実行

## 注意事項

- 横線は他の線と近すぎる位置には引けません
- 一度「結了」ボタンを押すと、新しい線は引けなくなります
- 「リセット」ボタンで最初の状態に戻せます
- 接続が切断された場合、自動的に再接続を試みます
- 状態は5秒ごとに自動保存されます

## 技術的な詳細

### 状態管理
- サーバー側で状態を管理し、JSONファイルに永続化
- 定期的な自動保存（5秒間隔）
- プロセス終了時の状態保存
- 起動時の状態復元

### 接続管理
- WebSocket優先、Pollingフォールバック
- 最大5回の再接続試行
- 接続状態の視覚的フィードバック
- エラー時の自動リカバリー機能
